# 如何测试文件查找功能

## 📋 说明

刚才的 `SystemExit: 1` 不是错误！只是测试脚本需要输入参数。

我创建了两个测试工具供你使用：

## 🎯 方法1：交互式测试（推荐）

**最简单的方式 - 直接运行，然后输入路径：**

```bash
python quick_test_file_search.py
```

然后会提示你输入路径：
```
请输入路径 > /path/to/your/data
```

**优点**：
- ✅ 不需要记住命令行参数
- ✅ 可以连续测试多个路径
- ✅ 友好的交互界面
- ✅ 输入 'q' 退出

## 🎯 方法2：命令行测试

**如果你知道具体路径，可以直接传参数：**

```bash
# 测试目录路径
python quick_test_file_search.py /path/to/your/data

# 测试通配符
python quick_test_file_search.py "/path/to/your/data/*.h5"

# 测试递归
python quick_test_file_search.py "/path/to/your/data/**/*.h5"
```

**注意**：路径中有空格或通配符时要加引号！

## 🎯 方法3：直接在GUI中测试

这是最直接的方式：

1. 打开你的应用
2. 进入 **Powder Integration** 模块
3. 在 **Input File** 输入框中输入你的数据目录路径
4. 点击 **Run Integration**
5. **查看Console窗口** - 会显示详细的文件搜索日志

你会看到：
```
🔍 Starting file search with input: /your/path
   Is directory: True
   Exists: True

📂 Method 2: Directory detected, searching recursively...
   Pattern: /your/path/**/*.h5
   Result: Found 25 files
   ✓ Success!
   Sample files: [file1.h5, file2.h5, ...]

✓ Final result: Found 25 HDF5 files to process
```

## 📝 测试示例

### 示例1：测试目录路径

**交互式：**
```bash
$ python quick_test_file_search.py
请输入路径 > /home/user/data
```

**命令行：**
```bash
python quick_test_file_search.py /home/user/data
```

### 示例2：测试当前目录

**交互式：**
```bash
$ python quick_test_file_search.py
请输入路径 > .
```

**命令行：**
```bash
python quick_test_file_search.py .
```

### 示例3：测试相对路径

**交互式：**
```bash
$ python quick_test_file_search.py
请输入路径 > data
```

**命令行：**
```bash
python quick_test_file_search.py data
```

### 示例4：测试带通配符的路径

**交互式：**
```bash
$ python quick_test_file_search.py
请输入路径 > /home/user/data/*.h5
```

**命令行：**
```bash
python quick_test_file_search.py "/home/user/data/*.h5"
```
**注意引号！**

## 🔍 输出解释

### 成功找到文件
```
✓ Success! Found 25 .h5 files
Sample files:
  - /path/to/data/run1/file1.h5
  - /path/to/data/run1/file2.h5
  - /path/to/data/run2/file3.h5
  ... and 22 more files
```

### 没有找到文件
```
⚠ ERROR: No matching .h5 files found!

📋 Searching for .h5 files in: /path/to/data
  /path/to/data/run1: 5 .h5 files
    - file1.h5
    - file2.h5
  /path/to/data/run2: 10 .h5 files
    - file3.h5
```
这说明文件存在，但搜索pattern有问题。

## 💡 常见问题

### Q1: SystemExit: 1 是什么？
**A**: 这只是脚本的退出提示，不是错误。原因是没有提供输入参数。

**解决方法**：
- 使用 `quick_test_file_search.py`（交互式，不需要参数）
- 或者给 `test_file_search.py` 提供路径参数

### Q2: 如何测试我的真实数据？
**A**: 三种方式任选：
1. **最简单**: 直接在GUI的Powder Integration中输入路径并运行
2. **调试用**: `python quick_test_file_search.py` 然后输入你的路径
3. **快速验证**: `python quick_test_file_search.py /your/real/path`

### Q3: 我的路径中有空格怎么办？
**A**: 
```bash
# 正确 ✅
python quick_test_file_search.py "/path/with spaces/data"

# 错误 ❌
python quick_test_file_search.py /path/with spaces/data
```

### Q4: 如何知道是否找到了所有文件？
**A**: 
1. 看日志中的 `Result: Found XX files`
2. 对比实际目录中的文件数量
3. 日志会列出示例文件路径，检查是否包含子目录的文件

## 🚀 快速开始

**最快的测试方式：**

```bash
# 1. 进入你的工作目录
cd /workspace

# 2. 运行交互式测试
python quick_test_file_search.py

# 3. 输入你的数据路径
请输入路径 > /your/data/path

# 4. 查看结果
```

或者直接在GUI中测试！

## 📞 如果还有问题

如果测试后仍然找不到文件，请：

1. **运行测试脚本**并复制完整输出
2. **检查路径是否正确存在**
3. **确认目录中确实有.h5文件**
4. **查看日志中的"📋 Directory contents"部分**

这会告诉我们具体是什么原因！

---

**测试工具文件**：
- `quick_test_file_search.py` - 交互式测试（推荐）
- `test_file_search.py` - 命令行测试

**主要代码**：
- `batch_integration.py` - 已经包含了相同的文件查找逻辑
