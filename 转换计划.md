# Auto Fitting 完整1:1转换计划

## 用户要求
1. 解决报错: 'AutoFittingModule' object has no attribute 'btn_bg_mode'
2. Batch Auto Fit 应该最初就可以点
3. **完整一比一转换，每一句都要转换**

## 原版文件结构 (auto_fitting.py, 2952行)

### 1. 导入部分 (1-50行)
- tkinter相关导入
- 科学计算库导入
- 数据处理类定义

### 2. 数据处理类 (51-620行)
- DataProcessor
- PeakDetector  
- PeakProfile
- BackgroundFitter
- PeakClusterer

### 3. 主GUI类 (621-2952行)
- __init__ (621-683)
- _create_control_panel (685-773)
- _create_background_panel (774-849)
- _create_smoothing_panel (850-907)
- _create_results_panel (908-940)
- _create_plot_area (941-970)
- _create_info_panel (971-984)
- 事件处理器 (986-1152)
- 文件操作 (1153-1266)
- 背景操作 (1267-1443)
- 平滑操作 (1444-1514)
- 峰操作 (1515-2119)
- 批处理 (2120-2952)

## Qt6转换策略

### tkinter → Qt6 对应关系
```
tk.Frame          → QFrame
tk.Button         → QPushButton
tk.Label          → QLabel
tk.Entry          → QLineEdit
tk.Text           → QTextEdit
tk.Checkbutton    → QCheckBox
ttk.Combobox      → QComboBox
ttk.Treeview      → QTableWidget
tk.StringVar      → 直接使用Python变量
.pack()           → QVBoxLayout/QHBoxLayout
.grid()           → QGridLayout
messagebox        → QMessageBox
filedialog        → QFileDialog
```

## 转换步骤

### 第1步: 修复当前错误 ✓
- 删除了btn_bg_mode但没删干净引用

### 第2步: 重新创建完整的__init__ 
- 逐行对比原版，确保所有变量都初始化

### 第3步: 重新创建所有UI面板
- 逐个函数转换，保持完全一致

### 第4步: 转换所有事件处理器
- 保持相同的逻辑和行为

### 第5步: 转换所有功能函数
- 每个函数都要完整转换

### 第6步: 测试验证
- 确保所有功能正常

## 当前进度
- [ ] 修复btn_bg_mode错误
- [ ] 设置Batch Auto Fit初始可用
- [ ] 完整重新转换整个文件
